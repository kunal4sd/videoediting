$(function(){$.ajaxSetup({data:{ajax:!0},global:!0}),$(document).ajaxError(function(e,t,a,n){var i=t.responseJSON;i&&i.message&&(i.message.csrf||i.message.authorization)&&global_functions.launch_modal_reload()})});var global_functions={form_to_json:function(e){var t=jQuery(e).serializeArray(),a={};return jQuery.each(t,function(){a[this.name]=this.value||""}),a},build_template:function(e,t){return new_element=e.clone(),new_element.removeAttr("name"),$.each(t,function(e,t){switch(e){case"keywords_name_en":var a=new_element.find("[data-toggle]");if(void 0!==a&&"tooltip"===a.attr("data-toggle"))return a.attr("title",t.length?t:"No Keywords"),!0;if("tooltip"===new_element.attr("data-toggle"))return new_element.attr("title",t.length?t:"No Keywords"),!0;break;case"status":var n=new_element.find('[name="status_badge"]');n.length&&(n.html(global_functions.build_status_badge(t)),new_element.find('[name="status"]').html(t));break;case"poster":var a=new_element.find('img[name="poster"]');if(void 0!==a)return t?a.attr("src",t):a=new_element.find('span[name="no_poster"]'),a.removeClass("d-none"),!0}var n=new_element.find('[name="'+e+'"]');if(n.length)return n.html(t),!0;var i="data-"+e;if(void 0!==new_element.attr(i))return new_element.attr(i,t),!0;var a=new_element.find("["+i+"]");return void 0!==a?(a.attr(i,t),!0):void 0}),new_element},launch_template:function(e,t){return e.appendTo(t),e},set_alerts_expiration:function(e){setTimeout(function(){$.each($(e).children('div[class*="alert"]'),function(e,t){var t=$(t);t.fadeOut(400,function(){t.alert("close")})})},3e3)},button_is_loading:function(e){e.attr("data-loading",1),e.attr("data-previous-value",e.html()),e.attr("disabled","disabled"),setTimeout(function(){1==e.attr("data-loading")&&e.html('<img height="24" src="/images/preloader_circle.gif">')},500)},button_is_not_loading:function(e){var t=e.attr("data-previous-value");"undefined"!=typeof t&&t!==!1&&(e.html(e.attr("data-previous-value")),e.removeAttr("data-previous-value")),e.removeAttr("disabled"),e.attr("data-loading",0)},set_playlist_to_videojs:function(e){event_emitter.trigger("videojs.update.src",[e,"video/MP2T"]),$("#video-video-to-episode").show()},set_poster_to_videojs:function(e){event_emitter.trigger("videojs.update.poster",e)},set_playlist_to_player:function(e,t){event_emitter.trigger("player.update.src",[e,t,"video/MP2T"])},set_poster_to_player:function(e,t){event_emitter.trigger("player.update.poster",[e,t])},reset_player:function(){var e=videojs.getPlayer("video-preview");e.hasStarted(!1),e.poster($("#video-preview").attr("poster")),e.posterImage.show(),e.bigPlayButton.show(),e.currentTime(0),e.reset(),e.src_(!1),$("#video-video-to-episode").hide()},refresh_playlist_holder_height:function(e){var t=$("#video-playlists-holder"),a=$("#video-get-playlist");if(t.height(418),void 0===e)var e=t.parent().height()-a.height();t.height(e)},register_actions:function(e){e.find('button[name="play-btn"]').unbind().on("click",function(t){var a=$(this),n=a.closest("tr"),i=n.find('td[name="id"]').html().trim(),o=data_table.rows();o.every(function(t,a,n){var o=this.data();if(o[table_cols_index.id]===i)return $.each(form_edit_article.find("input"),function(t,a){a=$(a);var n=a.attr("type");if("submit"===n)return!0;var i=a.attr("name");"csrf_name"===i?a.attr("value",e.find('input[name="csrf_name"]').val()):"csrf_value"===i?a.attr("value",e.find('input[name="csrf_value"]').val()):(a.val(o[table_cols_index[i]]),a.attr("value",o[table_cols_index[i]]))}),!1}),movie_modal.modal({show:!0}),movie_player.find("source").attr("src",$(this).attr("data-src")),movie_player[0].load(),movie_player[0].pause(),$.each(form_edit_article.find("input"),function(e,t){t=$(t);var a=t.attr("type");if("submit"===a)return!0}),event_emitter.trigger("movie.edit.open",n.find('td[name="id"]').html().trim())}),e.find('button[name="download-btn"]').unbind().on("click",function(e){window.location.href=$(this).attr("data-download")}),e.find('button[name="delete-btn"]').unbind().on("click",function(t){if(!is_loading){var a=$(this),n=a.attr("data-action-url"),i=a.closest("tr"),o=i.find('td[name="id"]').html().trim();o&&(is_loading=!0,global_functions.button_is_loading(a),$.ajax({method:"post",url:n,data:{id:o,csrf_name:e.find('input[name="csrf_name"]').val(),csrf_value:e.find('input[name="csrf_value"]').val()},complete:function(e){global_functions.button_is_not_loading(a),is_loading=!1,void 0!==e.responseJSON&&e.responseJSON.success&&i.remove()}}))}})},build_status_badge:function(e){var t=void 0;switch(e){case"pending":t=$('span[name="global_template_badge_warning"]').clone();break;case"approve":t=$('span[name="global_template_badge_info"]').clone();break;case"live":t=$('span[name="global_template_badge_secondary"]').clone();break;default:t=$('span[name="global_template_badge_success"]').clone()}return t.html(e),t.removeAttr("name"),t},unselect_playlists:function(e){if(void 0===e)var e=$("#video-playlists-holder").find(".list-group-item");$.each(e,function(e,t){t=$(t),t.removeClass("list-group-item-warning"),t.addClass("list-group-item-success")})},clear_episodes:function(){for(var e=videojs.getAllPlayers(),t=0;t<e.length;t++)e[t].id_.search("video-episode")>-1&&e[t].dispose();$("#video-episodes-holder").html(""),$("#video-episodes-to-movie").hide(),global_functions.refresh_playlist_holder_height()},launch_modal_reload:function(){var e=$("#modal-page-reload");e.modal({backdrop:"static",keyboard:!1}),e.find("button").off().on("click",function(){location.reload()})}};
$(function(){event_emitter=$(document);var e=$("#global-alerts-holder"),t=$("#global-templates-holder"),n=t.find('div[name="global_template_alert_danger"]'),a=t.find('div[name="global_template_alert_warning"]'),o=t.find('div[name="global_template_alert_info"]'),s=videojs.getPlayer("video-preview");event_emitter.on("show_global_errors",function(t,a,o){void 0===o&&(o=!0),$.each(a,function(t,a){var s=global_functions.launch_template(global_functions.build_template(n,{content:a}),e);o&&setTimeout(function(){s.fadeOut(400,function(){s.alert("close")})},3e3)})}),event_emitter.on("videojs.go_to_sec",function(e,t){var n=parseInt($("#from_second").val()),a=parseInt($("#from_minute").val()),o=parseInt($("#to_second").val()),s=parseInt($("#to_minute").val());n=n?n:0,a=a?a:0,o=o?o:0,s=s?s:0;var i=60*a+n,l=60*s+o,r=[];(o>59||o<0)&&r.push("To Sec Must be between 0 - 59"),(n>59||n<0)&&r.push("From Sec Must be between 0 - 59"),i>=l&&r.push("From time must be less than To time"),r.length?event_emitter.trigger("show_global_errors",[r]):t.playBetween(i,l)}),event_emitter.on("videojs.update.src",function(e,t,n){s.src([{type:n,src:t}])}),event_emitter.on("videojs.update.poster",function(e,t){s.poster(t)}),event_emitter.on("player.update.src",function(e,t,n,a){t.src([{type:a,src:n}])}),event_emitter.on("player.update.poster",function(e,t,n){t.poster(n)}),event_emitter.on("form.ajax.result.alert",function(t,s,i){var i=i;if(e.html(""),s.status>=400){if(void 0!==s.responseJSON){var l={};$.each(s.responseJSON.message,function(t,a){void 0!==i&&i.find('[name="'+t+'"]').addClass("is-invalid"),l=global_functions.launch_template(global_functions.build_template(n,{content:a}),e).attr("data-name",t),void 0!==i&&l.on("closed.bs.alert",function(){i.find('[name="'+$(this).attr("data-name")+'"]').removeClass("is-invalid")})})}}else if(302===s.status)void 0!==s.responseJSON.result&&void 0!==s.responseJSON.result.redirect_to&&window.location.replace(s.responseJSON.result.redirect_to);else{if(void 0!==s.responseJSON.result&&void 0!==s.responseJSON.result.warnings){var l={};$.each(s.responseJSON.result.warnings,function(t,n){void 0!==i&&i.find('[name="'+t+'"]').addClass("is-invalid"),l=global_functions.launch_template(global_functions.build_template(a,{content:n}),e).attr("data-name",t).addClass("mb-0"),void 0!==i&&l.on("closed.bs.alert",function(){i.find('[name="'+$(this).attr("data-name")+'"]').removeClass("is-invalid")})})}s.responseJSON.message&&global_functions.launch_template(global_functions.build_template(o,{content:s.responseJSON.message}),e).attr("data-name","info")}global_functions.set_alerts_expiration(e)})});
_vjs7={on:function(e,t,i,s){e.addEventListener(t,i,s)},off:function(e,t,i,s){e.removeEventListener(t,i,s)},addClass:function(e,t){e.classList.add(t)},removeClass:function(e,t){e.classList.remove(t)},findPosition:function(e){return e.getBoundingClientRect()},round:function(e,t){return parseFloat(e.toFixed(t))},formatTime:function(e){var t=Math.floor(e/60).toFixed(0),i=(e%60).toFixed(0);return 1===i.length&&(i="0"+i),t+":"+i},blockTextSelection:function(){}},function(){function e(e){var t={2:"The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.",5:"The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.",100:"The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.",101:"The owner of the requested video does not allow it to be played in embedded players.",150:"The owner of the requested video does not allow it to be played in embedded players."};return void 0===t[e]?"Unknown Error":t[e]}function t(t){function s(e){var t=o.rangeslider;for(var i in t.components)t.components[i].init_();t.options.hidden&&t.hide(),t.options.locked&&t.lock(),t.options.panel===!1&&t.hidePanel(),t.options.controlTime===!1&&t.hidecontrolTime(),t._reset(),o.trigger("loadedRangeSlider")}var o=this;o.rangeslider=new i(o,t),"Youtube"==o.techName?(o.one("error",function(t){alert(e(o.error))}),o.on("firstplay",s)):o.one("playing",s)}function i(e,t){var i=e||this;this.player=i,this.components={},t=t||{},t.hasOwnProperty("locked")||(t.locked=!1),t.hasOwnProperty("hidden")||(t.hidden=!0),t.hasOwnProperty("panel")||(t.panel=!0),t.hasOwnProperty("controlTime")||(t.controlTime=!0),this.options=t,this.init()}videojs.registerPlugin("rangeslider",t),i.prototype={init:function(){var e=this.player||{};this.updatePrecision=3,this.start=0,this.end=0;var t=e.controlBar,i=t.progressControl.seekBar;this.components.RSTimeBar=i.RSTimeBar,this.components.ControlTimePanel=t.ControlTimePanel,this.rstb=this.components.RSTimeBar,this.box=this.components.SeekRSBar=this.rstb.SeekRSBar,this.bar=this.components.SelectionBar=this.box.SelectionBar,this.left=this.components.SelectionBarLeft=this.box.SelectionBarLeft,this.right=this.components.SelectionBarRight=this.box.SelectionBarRight,this.tp=this.components.TimePanel=this.box.TimePanel,this.tpl=this.components.TimePanelLeft=this.tp.TimePanelLeft,this.tpr=this.components.TimePanelRight=this.tp.TimePanelRight,this.ctp=this.components.ControlTimePanel,this.ctpl=this.components.ControlTimePanelLeft=this.ctp.ControlTimePanelLeft,this.ctpr=this.components.ControlTimePanelRight=this.ctp.ControlTimePanelRight,this.ctsb=this.components.ControlTimeSetButton=this.ctp.ControlTimeSetButton},lock:function(){this.options.locked=!0,this.ctp.enable(!1),"undefined"!=typeof this.box&&_vjs7.addClass(this.box.el_,"locked")},unlock:function(){this.options.locked=!1,this.ctp.enable(),"undefined"!=typeof this.box&&_vjs7.removeClass(this.box.el_,"locked")},show:function(){this.options.hidden=!1,"undefined"!=typeof this.rstb&&(this.rstb.show(),this.options.controlTime&&this.showcontrolTime())},hide:function(){this.options.hidden=!0,"undefined"!=typeof this.rstb&&(this.rstb.hide(),this.ctp.hide())},showPanel:function(){this.options.panel=!0,"undefined"!=typeof this.tp&&_vjs7.removeClass(this.tp.el_,"disable")},hidePanel:function(){this.options.panel=!1,"undefined"!=typeof this.tp&&_vjs7.addClass(this.tp.el_,"disable")},showcontrolTime:function(){this.options.controlTime=!0,"undefined"!=typeof this.ctp&&this.ctp.show()},hidecontrolTime:function(){this.options.controlTime=!1,"undefined"!=typeof this.ctp&&this.ctp.hide()},setValue:function(e,t,i){i="undefined"==typeof i||i;var s=this._percent(t),o=0===e||1===e,n=!this.locked;n&&o&&this.box.setPosition(e,s,i)},setValues:function(e,t,i){i="undefined"==typeof i||i,this._reset(),this._setValuesLocked(e,t,i)},getValues:function(){var e,t;return e=this.start||this._getArrowValue(0),t=this.end||this._getArrowValue(1),{start:e,end:t}},playBetween:function(e,t,i){i="undefined"==typeof i||i,this.player.currentTime(e),this.player.play(),i?(this.show(),this._reset()):this.hide(),this._setValuesLocked(e,t),this.bar.activatePlay(e,t)},loop:function(e,t,i){var s=this.player;s&&(s.on("pause",videojs.bind(this,function(){this.looping=!1})),i="undefined"==typeof i||i,i?(this.show(),this._reset()):this.hide(),this._setValuesLocked(e,t),this.timeStart=e,this.timeEnd=t,this.looping=!0,this.player.currentTime(e),this.player.play(),this.player.on("timeupdate",videojs.bind(this,this.bar.process_loop)))},_getArrowValue:function(e){e=e||0;var t=this.player.duration();t="undefined"==typeof t?0:t;var i=this[0===e?"left":"right"].el_.style.left.replace("%","");return""===i&&(i=0===e?0:100),_vjs7.round(this._seconds(i/100),this.updatePrecision-1)},_percent:function(e){var t=this.player.duration();return isNaN(t)?0:Math.min(1,Math.max(0,e/t))},_seconds:function(e){var t=this.player.duration();return isNaN(t)?0:Math.min(t,Math.max(0,e*t))},_reset:function(){var e=this.player.duration();this.tpl.el_.style.left="0%",this.tpr.el_.style.left="100%",this._setValuesLocked(0,e)},_setValuesLocked:function(e,t,i){var s="undefined"!=typeof i;i="undefined"==typeof i||i,this.options.locked?(this.unlock(),this.setValue(0,e,i),this.setValue(1,t,i),this.lock()):(this.setValue(0,e,i),this.setValue(1,t,i)),s&&this._triggerSliderChange()},_checkControlTime:function(e,t,i){var s,o,n,r=t[0],l=t[1],a=r.value,h=l.value;if(e=e||0,a!=i[0])s=r,o=a,n=i[0];else{if(h==i[1])return!1;s=l,o=h,n=i[1]}var p,c=this.player.duration()||0,d=/^\d+$/;if((!d.test(o)||o>60)&&(o=""===o?"":n),a=""===a?0:a,h=""===h?0:h,p=60*parseInt(a)+parseInt(h),p>c?(s.value=n,s.style.border="1px solid red"):(s.value=o,s.style.border=r.style.border=l.style.border="1px solid transparent",this.setValue(e,p,!1),this._triggerSliderChange()),1===e){var u=this.ctpl.el_.children,f=60*u[0].value+u[1].value;p<f&&(s.style.border="1px solid red")}else{var y=this.ctpr.el_.children,m=60*y[0].value+y[1].value;p>m&&(s.style.border="1px solid red")}},_triggerSliderChange:function(){this.player.trigger("sliderchange")}};var s=videojs.getComponent("Player");s.prototype._v4=_vjs7,s.prototype.lockSlider=function(){return this.rangeslider.lock()},s.prototype.unlockSlider=function(){return this.rangeslider.unlock()},s.prototype.showSlider=function(){return this.rangeslider.show()},s.prototype.hideSlider=function(){return this.rangeslider.hide()},s.prototype.showSliderPanel=function(){return this.rangeslider.showPanel()},s.prototype.hideSliderPanel=function(){return this.rangeslider.hidePanel()},s.prototype.showControlTime=function(){return this.rangeslider.showcontrolTime()},s.prototype.hideControlTime=function(){return this.rangeslider.hidecontrolTime()},s.prototype.setValueSlider=function(e,t){return this.rangeslider.setValues(e,t)},s.prototype.playBetween=function(e,t){return this.rangeslider.playBetween(e,t)},s.prototype.loopBetween=function(e,t){return this.rangeslider.loop(e,t)},s.prototype.getValueSlider=function(){return this.rangeslider.getValues()};var o=videojs.getComponent("SeekBar");o.prototype.options_.children.push("RSTimeBar");var n=videojs.getComponent("ControlBar");n.prototype.options_.children.push("ControlTimePanel");var r=videojs.getComponent("Component"),l=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t)}});l.prototype.init_=function(){this.rs=this.player_.rangeslider},l.prototype.options_={children:{SeekRSBar:{}}},l.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-timebar-RS",innerHTML:""})},videojs.registerComponent("RSTimeBar",l);var a=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("mousedown",this.onMouseDown)}});a.prototype.init_=function(){this.rs=this.player_.rangeslider},a.prototype.options_={children:{SelectionBar:{},SelectionBarLeft:{},SelectionBarRight:{},TimePanel:{}}},a.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-holder"})},a.prototype.onMouseDown=function(e){e.preventDefault(),_vjs7.blockTextSelection(),this.rs.options.locked||(_vjs7.on(document,"mousemove",videojs.bind(this,this.onMouseMove)),_vjs7.on(document,"mouseup",videojs.bind(this,this.onMouseUp)))},a.prototype.onMouseUp=function(e){_vjs7.off(document,"mousemove",this.onMouseMove,!1),_vjs7.off(document,"mouseup",this.onMouseUp,!1)},a.prototype.onMouseMove=function(e){var t=this.calculateDistance(e);this.rs.left.pressed?this.setPosition(0,t):this.rs.right.pressed&&this.setPosition(1,t);var i=this.player_.controlBar.currentTimeDisplay;i.contentEl_.innerHTML='<span class="vjs-control-text">'+i.localize("Current Time")+"</span>"+_vjs7.formatTime(this.rs._seconds(t),this.player_.duration()),(this.rs.left.pressed||this.rs.right.pressed)&&this.rs._triggerSliderChange()},a.prototype.setPosition=function(e,t,i){if(i="undefined"==typeof i||i,e=e||0,this.rs.options.locked)return!1;if(isNaN(t))return!1;if(0!==e&&1!==e)return!1;var s=this.rs.left.el_,o=(this.rs.right.el_,this.rs[0===e?"left":"right"].el_),n=this.rs.tpr.el_,r=this.rs.tpl.el_,l=this.rs.bar,a=this.rs[0===e?"ctpl":"ctpr"].el_;if(0===e?l.updateLeft(t):l.updateRight(t)){o.style.left=100*t+"%",0===e?l.updateLeft(t):l.updateRight(t),this.rs[0===e?"start":"end"]=this.rs._seconds(t),0===e&&(t>=.9?s.style.zIndex=25:s.style.zIndex=10);var h,p,c,d=_vjs7.formatTime(this.rs._seconds(t)),u=r.children[0].innerHTML.length;if(c=u<=4?this.player_.isFullScreen?3.25:6.5:u<=5?this.player_.isFullScreen?4:8:this.player_.isFullScreen?5:10,d.length<=4?(h=this.player_.isFullScreen?97:93,p=this.player_.isFullScreen?.1:.5):d.length<=5?(h=this.player_.isFullScreen?96:95,p=this.player_.isFullScreen?.1:.5):(h=this.player_.isFullScreen?95:91,p=this.player_.isFullScreen?.1:.5),0===e?(r.style.left=Math.max(p,Math.min(h,100*t-c/2))+"%",n.style.left.replace("%","")-r.style.left.replace("%","")<=c&&(r.style.left=Math.max(p,Math.min(h,n.style.left.replace("%","")-c))+"%"),r.children[0].innerHTML=d):(n.style.left=Math.max(p,Math.min(h,100*t-c/2))+"%",(n.style.left.replace("%","")||100)-r.style.left.replace("%","")<=c&&(n.style.left=Math.max(p,Math.min(h,r.style.left.replace("%","")-0+c))+"%"),n.children[0].innerHTML=d),i){var f,y,m,v=d.split(":");2==v.length?(f=0,y=v[0],m=v[1]):(f=v[0],y=v[1],m=v[2]),a.children[0].value=y,a.children[1].value=m}}return!0},a.prototype.calculateDistance=function(e){var t=this.getRSTBX(),i=this.getRSTBWidth(),s=this.getWidth();return t+=s/2,i-=s,Math.max(0,Math.min(1,(e.pageX-t)/i))},a.prototype.getRSTBWidth=function(){return this.el_.offsetWidth},a.prototype.getRSTBX=function(){return _vjs7.findPosition(this.el_).left},a.prototype.getWidth=function(){return this.rs.left.el_.offsetWidth},videojs.registerComponent("SeekRSBar",a);var h=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("mouseup",this.onMouseUp),this.fired=!1}});h.prototype.init_=function(){this.rs=this.player_.rangeslider},h.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-selectionbar-RS"})},h.prototype.onMouseUp=function(){var e=this.rs.left.el_.style.left.replace("%",""),t=this.rs.right.el_.style.left.replace("%",""),i=this.player_.duration(),s=this.rs.updatePrecision,o=_vjs7.round(e*i/100,s),n=_vjs7.round(t*i/100,s);this.player_.currentTime(o),this.player_.play(),this.rs.bar.activatePlay(o,n)},h.prototype.updateLeft=function(e){var t=""!==this.rs.right.el_.style.left?this.rs.right.el_.style.left:100,i=parseFloat(t)/100,s=_vjs7.round(i-e,this.rs.updatePrecision);return e<=i+1e-5&&(this.rs.bar.el_.style.left=100*e+"%",this.rs.bar.el_.style.width=100*s+"%",!0)},h.prototype.updateRight=function(e){var t=""!==this.rs.left.el_.style.left?this.rs.left.el_.style.left:0,i=parseFloat(t)/100,s=_vjs7.round(e-i,this.rs.updatePrecision);return e+1e-5>=i&&(this.rs.bar.el_.style.width=100*s+"%",this.rs.bar.el_.style.left=100*(e-s)+"%",!0)},h.prototype.activatePlay=function(e,t){this.timeStart=e,this.timeEnd=t,this.suspendPlay(),this.player_.on("timeupdate",videojs.bind(this,this._processPlay))},h.prototype.suspendPlay=function(){this.fired=!1,this.player_.off("timeupdate",videojs.bind(this,this._processPlay))},h.prototype._processPlay=function(){if(this.player_.currentTime()>=this.timeStart&&(this.timeEnd<0||this.player_.currentTime()<this.timeEnd)){if(this.fired)return;this.fired=!0}else{if(!this.fired)return;this.fired=!1,this.player_.pause(),this.player_.currentTime(this.timeEnd),this.suspendPlay()}},h.prototype.process_loop=function(){var e=this.player;if(e&&this.looping){var t=e.currentTime();(t<this.timeStart||this.timeEnd>0&&this.timeEnd<t)&&e.currentTime(this.timeStart)}},videojs.registerComponent("SelectionBar",h);var p=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("mousedown",this.onMouseDown),this.pressed=!1}});p.prototype.init_=function(){this.rs=this.player_.rangeslider},p.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-handle vjs-selectionbar-left-RS",innerHTML:'<div class="vjs-selectionbar-arrow-RS"></div><div class="vjs-selectionbar-line-RS"></div>'})},p.prototype.onMouseDown=function(e){e.preventDefault(),_vjs7.blockTextSelection(),this.rs.options.locked||(this.pressed=!0,_vjs7.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),_vjs7.addClass(this.el_,"active"))},p.prototype.onMouseUp=function(e){_vjs7.off(document,"mouseup",this.onMouseUp,!1),_vjs7.removeClass(this.el_,"active"),this.rs.options.locked||(this.pressed=!1)},videojs.registerComponent("SelectionBarLeft",p);var c=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("mousedown",this.onMouseDown),this.pressed=!1}});c.prototype.init_=function(){this.rs=this.player_.rangeslider},c.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-rangeslider-handle vjs-selectionbar-right-RS",innerHTML:'<div class="vjs-selectionbar-arrow-RS"></div><div class="vjs-selectionbar-line-RS"></div>'})},c.prototype.onMouseDown=function(e){e.preventDefault(),_vjs7.blockTextSelection(),this.rs.options.locked||(this.pressed=!0,_vjs7.on(document,"mouseup",videojs.bind(this,this.onMouseUp)),_vjs7.addClass(this.el_,"active"))},c.prototype.onMouseUp=function(e){_vjs7.off(document,"mouseup",this.onMouseUp,!1),_vjs7.removeClass(this.el_,"active"),this.rs.options.locked||(this.pressed=!1)},videojs.registerComponent("SelectionBarRight",c);var d=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t)}});d.prototype.init_=function(){this.rs=this.player_.rangeslider},d.prototype.options_={children:{TimePanelLeft:{},TimePanelRight:{}}},d.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-timepanel-RS"})},videojs.registerComponent("TimePanel",d);var u=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t)}});u.prototype.init_=function(){this.rs=this.player_.rangeslider},u.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-timepanel-left-RS",innerHTML:'<span class="vjs-time-text">00:00</span>'})},videojs.registerComponent("TimePanelLeft",u);var f=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t)}});f.prototype.init_=function(){this.rs=this.player_.rangeslider},f.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-timepanel-right-RS",innerHTML:'<span class="vjs-time-text">00:00</span>'})},videojs.registerComponent("TimePanelRight",f);var y=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t)}});y.prototype.init_=function(){this.rs=this.player_.rangeslider},y.prototype.options_={children:{ControlTimePanelLeft:{},ControlTimePanelRight:{},ControlTimeSetButton:{}}},y.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-controltimepanel-RS vjs-control"})},y.prototype.enable=function(e){e="undefined"==typeof e||e,this.rs.ctpl.el_.children[0].disabled=e?"":"disabled",this.rs.ctpl.el_.children[1].disabled=e?"":"disabled",this.rs.ctpr.el_.children[0].disabled=e?"":"disabled",this.rs.ctpr.el_.children[1].disabled=e?"":"disabled"},videojs.registerComponent("ControlTimePanel",y);var m=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("keyup",this.onKeyUp),this.on("keydown",this.onKeyDown)}});m.prototype.init_=function(){this.rs=this.player_.rangeslider,this.timeOld={}},m.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-controltimepanel-left-RS",innerHTML:'Start: <input type="number" id="from_minute" maxlength="2" min="0" max="59" value="0"/>:<input type="number" id="from_second" maxlength="2" min="0" max="59" value="0"/>'})},m.prototype.onKeyDown=function(e){this.timeOld[0]=this.el_.children[0].value,this.timeOld[1]=this.el_.children[1].value},m.prototype.onKeyUp=function(e){this.rs._checkControlTime(0,this.el_.children,this.timeOld)};var v=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("keyup",this.onKeyUp),this.on("keydown",this.onKeyDown)}});v.prototype.init_=function(){this.rs=this.player_.rangeslider,this.timeOld={}},v.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-controltimepanel-right-RS",innerHTML:'End: <input type="number" id="to_minute" maxlength="2" min="0" max="59" value="0"/>:<input type="number" id="to_second" maxlength="2" min="0" max="59" value="0"/>'})},v.prototype.onKeyDown=function(e){this.timeOld[0]=this.el_.children[0].value,this.timeOld[1]=this.el_.children[1].value},v.prototype.onKeyUp=function(e){this.rs._checkControlTime(1,this.el_.children,this.timeOld)};var _=videojs.extend(r,{constructor:function(e,t){r.call(this,e,t),this.on("click",this.set)}});_.prototype.init_=function(){this.rs=this.player_.rangeslider,this.timeOld={}},_.prototype.createEl=function(){return r.prototype.createEl.call(this,"div",{className:"vjs-controltime-set-button",innerHTML:'<button type="button" class="btn btn-success btn-sm">SET</button>'})},_.prototype.set=function(e){event_emitter.trigger("videojs.go_to_sec",this.player())},videojs.registerComponent("ControlTimePanelLeft",m),videojs.registerComponent("ControlTimePanelRight",v),videojs.registerComponent("ControlTimeSetButton",_)}();
$(function(){event_emitter.on("article.delete.article",function(e,t,r,i){$.ajax({method:"post",url:r,data:i,complete:function(e){void 0!==e.responseJSON&&e.responseJSON.success&&(event_emitter.trigger("article.delete.article.done",t),event_emitter.trigger("form.ajax.result.alert",[e]))}})})});
$(function(){var t=$("#article-edit-article");t.on("submit",function(t){t.preventDefault();var e=$(this),r=e.attr("action"),a=global_functions.form_to_json(e);$.ajax({method:"post",url:r,data:a,complete:function(t){event_emitter.trigger("article.edit.article.done",[t,a]),event_emitter.trigger("form.ajax.result.alert",[t,e])}})})});
$(function(){var e=$("#article-edit-article"),t=e.find('input[name="keywords"]'),n=$("#article-keywords-selector"),a=n.attr("data-action"),r=n.attr("data-initial-action"),i=e.find('input[name="csrf_name"]').val(),o=e.find('input[name="csrf_value"]').val(),c=function(e){var a=[],r=e.result,i=!1;i=new Option("",0,!0,!0),n.html("").trigger("change");for(var o in r)a.push(r[o].id),i=new Option(r[o].text,r[o].id,!0,!0),n.append(i).trigger("change");t.attr("value",a.join(","))},s=function(e){return e.text};n.select2({width:"100%",tokenSeparators:[","],multiple:!0,closeOnSelect:!0,minimumInputLength:2,ajax:{placeholder:"Select Keywords",url:a,type:"POST",dataType:"json",data:function(e,t){return{string:e.term,csrf_name:i,csrf_value:o}},processResults:function(e){return{results:e.result}}},templateSelection:s}),n.on("change",function(){t.attr("value",n.val().join(","))}),event_emitter.on("movie.edit.open",function(e,t){$.ajax({url:r,type:"POST",data:{article_id:t,csrf_name:i,csrf_value:o},complete:function(e){void 0!==e.responseJSON&&e.responseJSON.success&&c(e.responseJSON)}})})});
$(function(){var t=$(document),n=$("#authenticate"),o=n.find('button[type="button"]'),i=!1;n.on("submit",function(n){if(n.preventDefault(),!i){i=!0;var a=$(this);global_functions.button_is_loading(o),$.ajax({method:"post",url:a.attr("action"),data:global_functions.form_to_json(a),complete:function(n){t.trigger("form.ajax.result.alert",[n,a]),global_functions.button_is_not_loading(o),i=!1}})}}),o.on("click",function(){n.trigger("submit")})});
$(function(){var e=$("input[name='start_date']"),t=$("input[name='end_date']"),a=e.flatpickr({enableTime:!0,enableSeconds:!0,time_24hr:!0,minuteIncrement:1,dateFormat:"Y-m-d H:i:S",defaultDate:e.length&&e.val().length?e.val():moment().format("YYYY-MM-DD 00:00:00"),maxDate:t.val(),onChange:function(e,t,a){n.set("minDate",t)}}),n=t.flatpickr({enableTime:!0,enableSeconds:!0,time_24hr:!0,minuteIncrement:1,dateFormat:"Y-m-d H:i:S",defaultDate:t.length&&t.val().length?t.val():moment().format("YYYY-MM-DD 00:00:00"),minDate:e.val(),onChange:function(e,t,n){a.set("maxDate",t)}})});
$(function(){var t=!1,e=$("#listing-get-list");if(0===e.length)return!1;var n=e.find('button[type="button"]'),a=$("#listing-status-approve"),i=$("#listing-status-pending"),r=$("#listing-status-live"),o=$("#listing-list-holder"),l=$("#listing-modal-edit-article"),s=$("#listing-modal-delete-article"),d=$("#listing-modal-movie-play"),u=$("#article-edit-article"),c=u.find("#listing-modal-edit-article-button-submit"),m=$("#global-templates-holder"),f=m.find('li[name="global_template_list_video"]'),v=$("#listing-video-table"),b={},h=[{name:"status"},{name:"keywords"},{name:"status_badge"},{name:"headline"},{name:"id"},{name:"issue_datetime"},{name:"created"},{name:"publication"},{name:"duration"},{name:"file_size"},{name:"actions"},{name:"text"}],g=function(t){for(var e in h)b[h[e].name]=parseInt(e);return t.DataTable({columns:h,columnDefs:[{targets:[b.keywords],visible:!1,searchable:!0},{targets:[b.text],visible:!1,searchable:!1},{targets:[b.status],visible:!1,searchable:!0}],order:[[b.id,"desc"]],select:!0})},p=g(v),_=function(t){p.destroy(),o.html(""),$.each(t,function(t,e){global_functions.launch_template(global_functions.build_template(w(f),e),o)}),p=g(v),y()},w=function(t){var e=t.clone(),n=e.prop("attributes"),a=$(document.createElement("tr")),i=e.find("ul");return $.each(i,function(t,e){e=$(e);var n=$(document.createElement("td")),i=e.prop("attributes");n.html(e.html()),$.each(i,function(){n.attr(this.name,this.value)}),a.append(n)}),$.each(n,function(){return"name"===this.name||void a.attr(this.name,this.value)}),a},y=function(){l.on("show.bs.modal",function(t){var e=$(t.relatedTarget),n=e.closest("tr"),a=n.find('td[name="id"]').html().trim(),i=p.rows();i.every(function(t,e,n){var i=this.data();if(i[b.id]===a)return D(i,!0),!1}),l.modal({show:!0}),d.find("source").attr("src",e.attr("data-src")),d[0].load(),d[0].pause(),event_emitter.trigger("movie.edit.open",n.find('td[name="id"]').html().trim())}),o.unbind("click").on("click",'button[name="download-btn"]',function(t){window.location.href=$(this).attr("data-download")}),s.on("show.bs.modal",function(t){var e=$(t.relatedTarget);s.unbind("click").on("click",'button[name="delete-btn"]',function(t){var n=e.attr("data-action-url"),a=e.closest("tr"),i=a.find('td[name="id"]').html().trim(),r={id:i,csrf_name:o.find('input[name="csrf_name"]').val(),csrf_value:o.find('input[name="csrf_value"]').val()};i&&event_emitter.trigger("article.delete.article",[e,n,r])})})},k=function(){d[0].pause(),$.each(u.find("input"),function(t,e){e=$(e);var n=e.attr("type");return"submit"===n||(e.val(""),e.attr("value",""),void e.removeAttr("disabled"))}),c.removeAttr("disabled")},D=function(t,e){var n=t[b.status];"live"===n&&e&&c.attr("disabled","disabled"),$.each(u.find("input"),function(a,i){if(i=$(i),"submit"===i.attr("type"))return!0;"live"===n&&e&&i.attr("disabled","disabled");var r=i.attr("name");"csrf_name"===r?i.attr("value",o.find('input[name="csrf_name"]').val()):"csrf_value"===r?i.attr("value",o.find('input[name="csrf_value"]').val()):(i.val(t[b[r]]),i.attr("value",t[b[r]]))})};c.on("click",function(t){t.preventDefault(),global_functions.button_is_loading(c),u.submit()}),event_emitter.on("article.delete.article.done",function(t,e){e=$(e);var n=e.closest("tr"),a=n.find('td[name="id"]').html().trim(),i=p.rows();i.every(function(t,e,n){var i=this.data();if(i[b.id]===a)return p.row(this).remove().draw(!0),!1}),s.modal("hide")}),event_emitter.on("article.edit.article.done",function(t,e,n){if(global_functions.button_is_not_loading(c),l.length&&void 0!==e.responseJSON&&e.responseJSON.success){var a=n.id,i=p.rows();i.every(function(t,e,i){var r=this.data();if(r[b.id]===a)return $.each(u.find("input"),function(t,e){e=$(e);var a=e.attr("type");if("submit"===a)return!0;var i=e.attr("name"),o=n[i];r[b[i]]=o,"status"===i&&(r[b.status_badge]=global_functions.build_status_badge(o).prop("outerHTML"))}),this.data(r),!1}),l.modal("hide"),y()}}),l.on("hidden.bs.modal",function(t){k()}),n.on("click",function(t){t.preventDefault(),e.trigger("submit")}),e.on("submit",function(e){if(e.preventDefault(),!t){t=!0;var a=$(this),i=global_functions.form_to_json(a);global_functions.button_is_loading(n),$.ajax({method:"post",url:a.attr("action"),data:i,complete:function(e){event_emitter.trigger("form.ajax.result.alert",[e,a]),global_functions.button_is_not_loading(n),t=!1,void 0!==e.responseJSON&&void 0!==e.responseJSON.result&&void 0!==e.responseJSON.result.videos&&_(e.responseJSON.result.videos)}})}}),a.add(i).add(r).on("click",function(t){t.preventDefault();var e=p.rows(".selected");if(e.count()){var n=$(this),a=n.data();e.every(function(t,e,n){var i=this.data();i[b.status]=a.value,D(i,!1),u.submit()})}})});
$(function(){var n=$("#listing-publication-select");if(0===n.length)return!1;var i=$("#listing-publication-input");n.select2(),n.on("change",function(){i.attr("value",n.val().join(","))})});
$(function(){var t=$("#listing-status-select");if(0===t.length)return!1;var n=$("#listing-status-input");t.select2(),t.on("change",function(){n.attr("value",t.val().join(","))})});
$(function(){var e=$("#video-episodes-holder");if(0===e.length)return!1;var t=0,o=0,i=3,s=videojs.getPlayer("video-preview"),r=$("#video-get-episode"),n=r.find('button[type="button"]'),a=!1,l=function(s,r){var n="video-episode-"+o;e.append('<div class="col-md-'+Math.floor(12/i)+'"><div class="row mx-auto"><video id="'+n+'" class="col-sm-12 video-js vjs-big-play-centered vjs-default-skin mr-2 mt-2" controls poster="/images/no_video.png" preload="auto" data-setup=\'{"inactivityTimeout":0,"width":426,"height":225,"playbackRates":[0.5,1,1.25,1.5,2]}\'></video></div><div class="row mx-auto"><button id="remove-'+n+'" class="col-sm-12 btn btn-danger btn-md oi oi-trash" style="top: 0px;"></button></div></div>'),$("#remove-"+n).unbind().on("click",function(e){$("#"+n).parent().parent().remove(),t--,0===t&&$("#video-episodes-to-movie").hide(),a.dispose(),global_functions.refresh_playlist_holder_height()});var a=videojs(n,{width:426,height:225,controls:!0,plugins:{}}),l={hidden:!0,responsive:!0,width:426,height:225};global_functions.set_playlist_to_player(a,s),global_functions.set_poster_to_player(a,r),a.currentTime(.1),a.rangeslider(l),o++,t++,t&&$("#video-episodes-to-movie").show()},d=function(e,t){return e>=0&&t>0&&e<t};n.on("click",function(e){e.preventDefault(),r.submit()}),r.on("submit",function(e){if(e.preventDefault(),!a){a=!0;var t=Math.floor(s.rangeslider.start),o=Math.ceil(s.rangeslider.end),i=s.currentSource();if(void 0!==i&&void 0!==i.src&&d(t,o)){var r=$(this),c=r.attr("action");global_functions.button_is_loading(n),$.ajax({method:"post",url:c,data:{from:t,to:o,playlist:i.src,csrf_name:r.find('input[name="csrf_name"]').val(),csrf_value:r.find('input[name="csrf_value"]').val()},complete:function(e){event_emitter.trigger("form.ajax.result.alert",[e]),global_functions.button_is_not_loading(n),a=!1,void 0!==e.responseJSON.result&&void 0!==e.responseJSON.result.src&&(l(e.responseJSON.result.src,e.responseJSON.result.poster),global_functions.refresh_playlist_holder_height())}})}else event_emitter.trigger("show_global_errors",[["Please load a playlist first and then set the time range correctly."]]),a=!1}})});
$(function(){var t=!1,e=$("#video-get-movie");if(0===e.length)return!1;var i=$("#video-new-movie"),n=$("#video-modal-delete-article"),o=e.find("#video-get-movie-submit-button"),a=$("#video-movies-holder"),l=$("#global-templates-holder"),r=l.find('li[name="global_template_list_movie"]'),s=$("#video-modal-edit-article"),d=$("#video-modal-movie-play"),u=$("#article-edit-article"),c=u.find("#video-modal-edit-article-button-submit"),m=function(t){global_functions.build_template(r,t).prependTo(a),v()},v=function(){a.find('button[name="play-btn"]').unbind().on("click",function(t){var e=$(this),i=e.closest("li"),n=i.find('[name="status"]').html();d.find("source").attr("src",$(this).attr("data-src")),d[0].load(),d[0].pause(),"live"===n&&c.attr("disabled","disabled"),$.each(u.find("input"),function(t,e){e=$(e);var o=e.attr("type");if("live"===n&&e.attr("disabled","disabled"),"submit"===o)return!0;var a=e.attr("name"),l=i.find('[name="'+a+'"]'),r=l.html();void 0!==r&&0!==r.length||(r=l.val()),void 0!==r&&(r=r.trim(),e.val(r),e.attr("value",r))}),s.modal({show:!0}),event_emitter.trigger("movie.edit.open",i.find('div[name="id"]').html().trim())}),a.find('button[name="download-btn"]').unbind().on("click",function(t){window.location.href=$(this).attr("data-download")}),n.on("show.bs.modal",function(t){var e=$(t.relatedTarget);n.unbind("click").on("click",'button[name="delete-btn"]',function(t){var i=e.attr("data-action-url"),n=e.closest("li"),o=n.find('div[name="id"]').html().trim(),l={id:o,csrf_name:a.find('input[name="csrf_name"]').val(),csrf_value:a.find('input[name="csrf_value"]').val()};o&&event_emitter.trigger("article.delete.article",[e,i,l])})})},f=function(){d[0].pause(),$.each(u.find("input"),function(t,e){e=$(e);var i=e.attr("type");return"submit"===i||(e.val(""),e.attr("value",""),void e.removeAttr("disabled"))}),c.removeAttr("disabled")};event_emitter.on("movie.get.list",function(t,e){$.ajax({method:"post",url:a.attr("data-movie-list-url"),data:e,complete:function(t){if(void 0!==t.responseJSON&&t.responseJSON.success&&void 0!==t.responseJSON.result&&Array.isArray(t.responseJSON.result.movies)){a.html("");for(var e in t.responseJSON.result.movies)m(t.responseJSON.result.movies[e])}}})}),o.on("click",function(t){t.preventDefault(),e.submit()}),c.on("click",function(t){t.preventDefault(),global_functions.button_is_loading(c),u.submit()}),event_emitter.on("article.delete.article.done",function(t,e){$(e).closest("li").remove(),n.modal("hide")}),event_emitter.on("article.edit.article.done",function(t,e){if(global_functions.button_is_not_loading(c),s.length&&void 0!==e.responseJSON&&e.responseJSON.success){var i=u.find('input[name="id"]').val(),n=a.find('div[name="id"]'),o=!1;$.each(n,function(t,e){if(e=$(e),e.html().trim()===i)return o=e.closest("li"),!1}),o&&$.each(u.find("input"),function(t,e){e=$(e);var i=e.attr("type");if("submit"===i)return!0;var n=e.attr("name"),a=e.val(),l=o.find('[name="'+n+'"]');void 0!==l.attr("value")?l.val(a):l.html(a),"status"===n&&o.find('[name="status_badge"]').html(global_functions.build_status_badge(a).prop("outerHTML"))}),s.modal("hide")}}),s.on("hidden.bs.modal",function(t){f()}),e.on("submit",function(e){if(e.preventDefault(),!t){t=!0;for(var n=videojs.getAllPlayers(),a=[],l=0;l<n.length;l++){var r=n[l];r.id_.search("video-episode")>-1&&a.push(r.currentSource().src)}if(a.length){var s=$(this),d=s.attr("action"),u=global_functions.form_to_json(s);u.episodes=a,global_functions.button_is_loading(o),$.ajax({method:"post",url:d,data:u,complete:function(e){event_emitter.trigger("form.ajax.result.alert",[e,s]),global_functions.button_is_not_loading(o),t=!1,void 0!==e.responseJSON&&e.responseJSON.success&&(m(e.responseJSON.result),i.modal("hide"),global_functions.clear_episodes(),s.find('input[name="title"]').val(""))}})}}}),v()});
$(function(){var t=$("#video-get-playlist");if(0===t.length)return!1;var e=$("#video-playlists-holder"),l=$("#global-templates-holder"),o=l.find('div[name="global_template_alert_playlist"]'),n=t.find('button[type="button"]'),i=!1,s=function(t){$.each(t,function(t,l){global_functions.launch_template(global_functions.build_template(o,l),e)}),a(),global_functions.refresh_playlist_holder_height()},a=function(){var t=e.find(".list-group-item");t.unbind().on("click",function(){var e=$(this),l=e.data();global_functions.reset_player(),global_functions.unselect_playlists(t),e.addClass("list-group-item-warning"),e.removeClass("list-group-item-success"),global_functions.set_playlist_to_videojs(l.url),global_functions.set_poster_to_videojs(l.poster)})},r=function(){$("#video-movies-holder").html("")},u=function(){e.html("")};n.on("click",function(e){e.preventDefault(),t.trigger("submit")}),t.on("submit",function(t){if(t.preventDefault(),r(),global_functions.clear_episodes(),u(),global_functions.reset_player(),!i){i=!0;var e=$(this),l=global_functions.form_to_json(e);global_functions.button_is_loading(n),event_emitter.trigger("movie.get.list",l),$.ajax({method:"post",url:e.attr("action"),data:l,complete:function(t){event_emitter.trigger("form.ajax.result.alert",[t,e]),global_functions.button_is_not_loading(n),i=!1,void 0!==t.responseJSON&&void 0!==t.responseJSON.result&&void 0!==t.responseJSON.result.playlists&&s(t.responseJSON.result.playlists)}})}}),a()});
$(function(){var e=videojs.getPlayer("video-preview"),n=$("#video-clear-player"),l=25,i=setInterval(function(){void 0!==e?(e.ready(function(){var n={hidden:!1,responsive:!0,width:800,height:400,controlTime:!0,controlBar:{volumePanel:{inline:!1,vertical:!0}}};e.rangeslider(n)}),clearInterval(i)):0===l&&clearInterval(i),l--},200);n.on("click",function(e){e.preventDefault(),global_functions.reset_player(),global_functions.unselect_playlists()})});